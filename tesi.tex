\documentclass[corpo=11pt, stile=classica, tipotesi=custom,
greek, evenboxes, english]{toptesi}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}

\usepackage{hyperref}
\hypersetup{%
	pdfpagemode={UseOutlines},
	bookmarksopen,
	pdfstartview={FitH},
	colorlinks,
	linkcolor={blue},
	citecolor={blue},
	urlcolor={blue}
}

\usepackage{geometry} %for the margins
\newcommand\fillin[1][4cm]{\makebox[#1]{\dotfill}} %for the dotted line in the frontispiace

\usepackage{dcolumn}
\newcolumntype{d}{D{.}{.}{-1} } %to vetical align numbers in tables, along the decimal dot

\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathrsfs}
%\usepackage{dutchcal}

\DeclareMathAlphabet{\mathdutchcal}{U}{dutchcal}{m}{n}
\SetMathAlphabet{\mathdutchcal}{bold}{U}{dutchcal}{b}{n}
\DeclareMathAlphabet{\mathdutchbcal}{U}{dutchcal}{b}{n}

\usepackage{esint}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage{systeme}
\usepackage{mathtools}
\hypersetup{colorlinks, linkcolor=blue, citecolor=blue}
\usepackage{cancel}
\usepackage{color}
\usepackage[
backend=bibtex,
style=numeric,
sorting=nyt
]{biblatex}
\addbibresource{bibliografia.bib}


\numberwithin{equation}{chapter}
\newtheorem{teo}{Theorem}[chapter] %in questo modo la numerazione ricomincia da capo ad ogni nuovo capitolo
\newtheorem{defi}[teo]{Definition}
\newtheorem{lem}[teo]{Lemma}
\newtheorem{cor}[teo]{Corollary}
\newtheorem{prop}[teo]{Proposition}
\newtheorem{es}[teo]{Example}

\newcommand{\R}{\mathbb{R}} %scorciatoia per R reali
\newcommand{\N}{\mathbb{N}} %scorciatoia per N naturali
\newcommand{\V}{\mathcal{V}} %STFT
\newcommand{\F}{\mathscr{F}} %Fourier transform
\newcommand{\Fock}{\mathcal{F}} %Fock space
\newcommand{\C}{\mathbb{C}} %Complex numbers
\newcommand{\B}{\mathscr{B}} %Bounded linear operators
\newcommand{\Barg}{\mathcal{B}} %Bargmann transform
\renewcommand{\L}{\mathscr{L}} %sesquilinear form localization operator
\newcommand{\dxdo}{dxd\omega}
\newcommand{\notazione}{\underline{\textbf{Remark Notazionale}}}
\newcommand{\Log}{\ensuremath{\text{Log}_-}}
\newcommand{\finire}{\fbox{\LARGE DA FINIRE}}
\newcommand{\pfrac}[2]{\dfrac{\partial #1}{\partial #2}}
\DeclareMathOperator*{\esssup}{ess\,sup}

\begin{document}
\english
	
\input{./title.tex}

\tableofcontents

\ringraziamenti

\sommario

\chapter{Introduction}
{\color{blue} Con il blu indico frasi da mettere a posto o dove manca una citazione.}\\
{\color{red} Con il rosso indico frasi da controllare se sono corrette.}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Preliminaries}\label{chapter preliminaries}
In this first chapter we briefly recall some basics definition and results about functional analysis and Fourier transform. In section \ref{section basics of functional analysis} basic concepts about operators between Banach spaces are presented. In section \ref{section Fourier transform and its properties} Fourier transform is defined and essential properties are given.
\section{Basics of Functional Analysis}\label{section basics of functional analysis}
In this section we focus our attention on linear operators between Banach spaces. Across the section a generic Banach space will be denoted as $X$ (or $Y$) endowed with the norm $\| \cdot \|_X$. In case $X$ is an Hilbert space we will denote its inner product as $\langle \cdot, \cdot \rangle_X$.\\
A generic linear operator between two Banach spaces $X$ and $Y$ will be denoted as $T : X \rightarrow Y$. As a standard notation, the image of $x \in X$ through $T$ will be indicated as $T(x)$, or equivalently as $Tx$.
\begin{defi}\label{bounded operator}
	A linear operator $T : X \rightarrow Y$ is \textbf{bounded} if there exist $C>0$ such that
	\begin{equation}\label{boundedness property}
		\| Tx \|_Y \leq C \| x \|_X \quad \forall x \in X
	\end{equation}
\end{defi}
For linear operator boundedness is strictly related to continuity as the subsequent theorem states.
\begin{teo}\label{equivalente boundedness continuity}
	For a linear operator $T$ the following statements are equivalent:
	\begin{itemize}
		\item $T$ is continuous
		\item $T$ is bounded.
	\end{itemize}
\end{teo}
We denote the set of linear bounded (continuous) operators from $X$ to $Y$ as $\B(X,Y)$, while if $X=Y$ we will just write $\B(X)$.\\
For the sake of completeness we mention that actually, for linear operators, boundedness is equivalent to uniform continuity.

After this we define the \emph{norm} of an operator
\begin{defi}\label{norm operator}
	Given a linear bounded operator $T$ we define its \textbf{norm} as the following number:
	\begin{equation*}
		\|T\| \coloneqq \inf\{C>0 : \| Tx \|_Y \leq C \| x \|_X \  \forall x \in X\} = \sup \left\{ \dfrac{\| Tx \|_Y}{\| x \|_X} : x \in X \setminus \{0\}\right\}
	\end{equation*}
\end{defi}
The proof of the equivalence between two definition is straightforward. We see that the norm of an operator is the best constant for which boundedness property \eqref{boundedness property} holds. {\color{blue} Sometimes, in order to emphasize the spaces between which $T$ operates, we may write the norm of $T$ as $\| T \|_{X \rightarrow Y}$.}\\
In the following we will mostly deal with $X$ and $Y$ being $L^2(\R^d)$, which is an Hilbert space. {\color{red} For operators between Hilbert spaces we can give the norm of an operator by means of the dual norm}:
\begin{equation*}
	\| T \| = \sup\{\langle Tx, y \rangle_X : x,y \in X\}
\end{equation*}

An important class of operators is the class of \emph{compact operators}.
\begin{defi}\label{compact operator}
	A linear bounded operator $T$ is \textbf{compact} if for every bounded sequence $\{x_n\}_{n \in \N} \subset X$ the sequence of the images $\{Tx_n\}_{n \in \N} \subset Y$ has a converging subsequence.
\end{defi}
The property of compactness can be stated in multiple ways \textbf{SERVE SCRIVERLE?}.

Now we suppose $X$ and $Y$ to be Hilbert spaces. Given $T \in \B(X,Y)$ there exist a unique $T^* \in \B(Y,X)$ such that:
\begin{equation*}
	\langle Tx, y \rangle_X = \langle x, T^* y \rangle_Y \quad \forall x \in X,\,y \in Y
\end{equation*}
$T^*$ is called the \textbf{adjoint} operator of $T$. In the particular case in which $T : X \rightarrow X$, if $T=T^*$, we say that $T$ is \textbf{self-adjoint}.

From now on we suppose that $X$ is over the field $\C$ and that $T \in \B(X)$.
\begin{defi}\label{spectrum def}
	The set $\sigma(T) = \{\lambda \in \C : T - \lambda I \text{ is not invertible}\}$ is called  the \textbf{spectrum} of $T$.
\end{defi}
For operators between finite-dimensional spaces (matrices) the spectrum is made up of \emph{eigenvalues}, those $\lambda \in \C$ such that $T-\lambda I$ is not injective. On the other hand, when dealing with infinite-dimensional spaces, this is no more true. Eigenvalues are in the so called \emph{point spectrum}, which in general is just a part of the whole spectrum.

If an operator is compact or self-adjoint its spectrum has some additional properties.
\begin{teo}[Fredholm's alternative]\label{Fredholm alternative}
	Let $T \in \B(X)$ be a compact operator. Then for $T-I$ one and only one of the following happens:
	\begin{itemize}
		\item $T$ is invertible
		\item $T$ is not injective
	\end{itemize}
\end{teo}
Therefore for compact operators, all the values in the spectrum, except at most for 0, are eigenvalues.\\
Another fundamental result arises if we study the spectrum of compact and self-adjoint operators.
\begin{teo}\label{self-adjoint compact operators are diagonalizable}
	Let $X$ be a separable Hilbert space and $T \in \B(X)$ a compact and self-adjoint operator. Then there exist an orthonormal basis of $X$ composed of eigenvectors of $T$
\end{teo}
Hence self-adjoint compact operators can always be diagonalized in some suitable basis (\cite{brezis}).

Now we are going to consider two important classes of operators: \emph{trace class} operators and \emph{Hilbert-Schmidt} operators.\\
The trace of an operator can be defined as it is for matrices.
\begin{defi}\label{positive operator}
	Let $X$ be an Hilbert space. An operator $T \in \B(X)$ is said \textbf{positive} if
	\begin{equation*}
		\langle T x, x \rangle \geq 0 \quad \forall x \in X
	\end{equation*}
\end{defi}
\begin{defi}\label{trace def}
	Let $X$ be a separable Hilbert space with orthonormal basis $\{e_n\}_{n \in \N}$. Given $T \in \B(X)$ a positive operator we define the \textbf{trace} of $T$ as
	\begin{equation*}\label{trace expression}
		\mathrm{tr}(T) = \sum_{n=1}^{\infty} \langle A e_n, e_n \rangle
	\end{equation*}
\end{defi}
Actually one should show that the definition is well posed, namely that is independent of the basis.
\begin{prop}\label{trace is well-deefined}
	The definition of $\mathrm{tr}$ given by \eqref{trace expression} is independent of the basis.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}

{\color{red}The definition of trace is given only for positive operators. If we want to deal with general ones it is sufficient to consider $|T|=\sqrt{T^*T}$ \textbf{LA PARTE SU RADICE QUADRATA E MODULO DI UN OPERATORE VA AGGIUNTA??}}
\begin{defi}\label{trace class def}
	An operator $T \in \B(X)$ is called \textbf{trace class} if and only if $\mathrm{tr}|T| < \infty$
\end{defi}
\begin{teo}
	For every trace class operator one has $\| T \| \leq \mathrm{tr}(T)$.
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
\begin{teo}
	Every trace class operator is compact.
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
\begin{defi}\label{Hilbert-Schmidt operator def}
	An operator $T \in \B(X)$ is called \textbf{Hilbert-Schmidt} if and only if $\mathrm{tr}(T^*T) < \infty$.
\end{defi}
\begin{teo}\label{Hilbert-Schmidt operators are compact}
	Every Hilbert-Schmidt operator is compact.
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
The importance of Hilbert-Schmidt operator is related to the following theorem.
\begin{teo}
	Let $X = L^2(\R^d)$. Then $T \in \B(L^2(\R^d))$ is Hilbert-Schmidt if only if there exist a function $K \in L^2(\R^d \times \R^d)$, called integral kernel, such that
	\begin{equation}\label{Hilbert-Schmidt integral operator}
		(Tf)(x) = \int_{\R^d} K(x,y)f(y)dy \quad \forall f \in L^2(\R^d).
	\end{equation}
	Moreover $\mathrm{tr}(T^*T) = \int_{\R^{2d}} |K(x,y)|^2 dxdy$.
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
In light of this theorem, operators defined by \eqref{Hilbert-Schmidt integral operator} are called \emph{Hilbert-Schmidt integral operators}.

\begin{prop}\label{condition integral operator self-adjoint}
	An Hilbert-Schmidt integral operator with kernel $K$ is self-adjoint if and only if $K(x,y) = \overline{K(y,x)}$.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}


\begin{itemize}
	\item Norma operatoriale (FATTO)
	\item Operatori autoaggiunti? (FATTO)
	\item Operatori compatti (FATTO)
	\item Spettro operatori (FATTO)
	\item Operatori di classe traccia
	\item Operatori di Hilbert-Schmidt?
\end{itemize}
\section{Fourier Transform and its properties}\label{section Fourier transform and its properties}
\begin{defi}\label{Fourier transform def}
	Let $f \in L^1(\R^d)$. We define the \textbf{Fourier transform} of $f$ the function
	\begin{equation}\label{Fourier transform formula}
		\F f(\omega) = \hat{f}(\omega) \coloneqq \int_{\R^d} e^{-2 \pi i \omega \cdot t} f(t) dt
	\end{equation}
\end{defi}
It is straightforward to see that the definition is well-posed and that $\F f \in L^{\infty}(\R^d)$ with $\|\F f\|_{\infty} \leq \| f \|_1$. Therefore $\F$ can be seen as a linear operator between $L^1(\R^d)$ and $L^{\infty}(\R^d)$ with $\| \F \| = 1$ (from the previous inequality actually we saw that $\| \F \| \leq 1$ but if we take $f \geq 0$ a.e. we have that $\hat{f}(0) = \| f \|_1$ that gives us the equality).\\
The Fourier transform of an $L^1(\R^d)$ is not only bounded, as stated by the \emph{Riemann-Lebesgue lemma}.
\begin{teo}[Riemann-Lebesgue lemma]\label{Riemann-Lebesgue lemma}
	Let $f \in L^1(\R^d)$. Therefore $\hat{f} \in C_0(\R^d) = \{f : \R^d \rightarrow \C \text{ continuous such that } \lim_{|t| \rightarrow \infty} |f(t)|=0\}$.
\end{teo}
\begin{defi}\label{inverse Fourier transform def}
	Let $f \in L^1(\R^d)$. We define the \textbf{inverse Fourier transform} of the function $f$
	\begin{equation}\label{inverse Fourier transform formula}
		\F^{-1} f(t) = \check{f}(t) \coloneqq \int_{\R^d} e^{2 \pi i \omega \cdot t} f(\omega) d\omega
	\end{equation}
\end{defi}
The inverse Fourier transform is denoted with $\F^{-1}$ because it is actually the inverse operator of the Fourier transform as stated by the \emph{inversion theorem}.
\begin{teo}[Inversion theorem]\label{inversion theorem}
	Let $f \in L^1(\R^d)$ and suppose that also $\hat{f} \in L^1(\R^d)$. Then
	\begin{equation*}
		f(t) = \F^{-1} \circ \F f(t) = \int_{\R^d} \hat{f}(\omega) e^{2 \pi i \omega \cdot t}d\omega
	\end{equation*}
\end{teo}

The Fourier transform is intimately related to regularity and decay properties. The duality between these two is stated in the following theorems.
\begin{teo}\label{duality decay-regularity theorem}
	Let $f \in L^1(\R^d)$. If $|t|^k f \in L^1(\R^d)$ for some $k \in \N$ then $\hat{f} \in C_0^k(\R^d)$ and the following holds for every $\alpha \in \N^d$ with $|\alpha| \leq k$:
	\begin{equation*}
		\F \left((-2 \pi i t)^{\alpha} f \right) (\omega) = \partial^{\alpha} \F f(\omega).
	\end{equation*}
\end{teo}
\begin{teo}\label{duality regularity-decay theorem}
	Let $f \in C^k(\R^d)$ for some $k \in \N$. If $f, \partial^{\alpha}f \in L^1(\R^d)$ for every $\alpha \in \N^d$ with $|\alpha| \leq k$ then
	\begin{equation*}
		\F \left(\partial^{\alpha} f\right) (\omega) = \left(2 \pi i \omega\right)^{\alpha} \F f(\omega)
	\end{equation*}
	In particular this implies that $\hat{f}(\omega) = o\left(|\omega|^{-k} \right) $ as $| \omega | \rightarrow \infty$.
\end{teo}
{\color{blue}To sum up, previous theorems state a duality between regularity and decay: if a function is smooth then its Fourier transform decays rapidly and vice versa.}


If $f$ is in $L^2(\R^d)$, the integral in \eqref{Fourier transform formula} in general will not converge. Nevertheless we can define the Fourier transform of an $L^2$ function through a density argument. For example, one can use $L^2(\R^d) \cap L^1(\R^d)$, which is a dense subspace of $L^2(\R^d)$. On this space one can show that the Fourier transform is an isometry with respect to the $L^2$ norm and therefore it extends to an isometry on the whole $L^2(\R^d)$. This is stated by the \emph{Plancherel theorem}.
\begin{teo}[Plancherel theorem]\label{Plancherel theorem}
	If $f \in L^1(\R^d) \cap L^2(\R^d)$ then $\| f \|_2 = \| \hat{f} \|_2$.
\end{teo}
Thanks to the polarization identity this implies that $\F$ preserves the inner product in $L^2(\R^d)$:
\begin{equation}\label{Parseval formula}
	\langle f,g \rangle_{L^2(\R^d)} = \langle \hat{f}, \hat{g} \rangle_{L^2(\R^d)} \quad \forall f,g \in L^2(\R^d)
\end{equation}
therefore the Fourier transform $\F$ is a unitary operator on $L^2(\R^d)$. Result \eqref{Parseval formula} is called \emph{Parseval formula}.

Lastly, we introduce two fundamental operators in Fourier analysis. Given $x,\omega \in \R^d$ we define the \emph{time-shift} (or translation) operator $T_x$
\begin{equation}\label{time-shift operator def}
	T_x f(t) = f(t-x)
\end{equation}
and the \emph{modulation} operator $M_{\omega}$
\begin{equation}\label{modulation operator def}
	M_{\omega} f(t) = e^{2 \pi i \omega \cdot t} f(t)
\end{equation}
{\color{blue} Va aggiunta anche la composizione e le loro proprietà?}
These can be combined into a \emph{time-frequency shift} operator
\begin{equation}\label{time-frequency shift def}
	\pi(x,\omega) f(t) = M_{\omega} T_x f(t)
\end{equation}
{\color{blue}\begin{teo}[Hausdorff-Young]
	Let $1 \leq p \leq 2$ and let $p'$ such that $\frac{1}{p} + \frac{1}{p'} = 1$. Then $\F : L^p(\R^d) \rightarrow L^{p'}(\R^d)$ and $\| \hat{f }\|_{p'} \leq \| f \|_p$.
\end{teo}}

	\begin{itemize}
		\item Defizione trasformata (FATTO)
		\item Teorema di Plancherel (FATTO)
		\item Formula di inversione(FATTO)
		\item Proprietà di decadimento e regolarità (FATTO)
		\item Proprietà operatori di traslazione e modulazione??
		\item Disuguaglianza di Hausdorff-Young ??
	\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Short-Time Fourier Transform}\label{chapter STFT}
\section{STFT}\label{section STFT}
{\color{red}The \emph{short-time Fourier transform} or \emph{STFT} is a powerful tool, introduced by Gabor in \cite{gabor}, used to study properties of a signal locally both in time and frequency. The main idea behind the STFT is the following: if we want some information of the spectrum of a signal around a specific time, say $T$, we could choose an interval $(T-\Delta T, T + \Delta T)$ and take the Fourier transform of $f \chi_{(T-\Delta T, T + \Delta T)}$. Usually multiplying by a characteristic function will not give us a regular function (not even continuous) and in light of the duality between regularity and decay, the Fourier transform of $f \chi_{(T-\Delta T, T + \Delta T)}$ will not decay rapidly. Therefore a sharp cutoff in the time domain will result in a ``bad'' localization in the frequency domain. In order to avoid this kind of problems we could think to multiply the signal $f$ by a smooth function.}
\begin{defi}\label{STFT def}
	Fix a function $\phi \neq 0$ called \emph{window function}. The \textbf{short-time Fourier transform} of a function $f$ with window $\phi$ is defined as
	\begin{equation}\label{STFT formula}
		\V_{\phi}f(x,\omega) = \int_{\R^d} f(t)\overline{\phi(t-x)}e^{-2 \pi i \omega \cdot t} dt, \quad (x,\omega) \in \R^{2d}
	\end{equation}
\end{defi}
In the above definition we did not specify where $f$ and $\phi$ are chosen. Since we are taking the Fourier transform of the function $f T_x\overline{\phi}$, the STFT is well defined whenever the Fourier transform of this function is. For example if both $f$ and $\phi$ are in $L^2(\R^d)$ then $f T_x\overline{\phi}$ is in $L^1(\R^d)$ for every $x \in \R^d$ and so the integral in \eqref{STFT formula} is defined. In this special case the STFT can be written as a scalar product in $L^2(\R^d)$:
\begin{equation*}
	\V_{\phi}f(x,\omega) = \langle f, M_{\omega} T_x \phi \rangle = \langle f, \pi(x,\omega) \phi \rangle
\end{equation*}
In general, the STFT of $f$ with respect to $\phi$ will be defined whenever  $\langle f, M_{\omega} T_x \phi \rangle$ is an expression of some sort of duality. For example, if $f \in \mathcal{S}'(\R^d)$ and $\phi \in \mathcal{S}(\R^d)$ then $M_{\omega} T_x \overline{\phi} \in \mathcal{S}(\R^d)$, therefore $\langle f, M_{\omega} T_x \phi \rangle$ can be seen as the usual duality between tempered distributions and functions in the Schwartz space.\\
{\color{blue} Aggiungere scritture equivalenti della STFT??}
\subsection{Properties of STFT}
In this section we will present and prove some properties about the STFT. An excellent reference is \cite{grochenig}.
\begin{teo}\label{orthogonality relations theorem}
	Let $f_1,f_2,\phi_1,\phi_2 \in L^2(\R^d$). Then $\V_{\phi_i}f_i \in L^2(\R^{2d})$ and the following holds:
	\begin{equation}\label{orthogonality relation formula}
		\langle \V_{\phi_1} f_1, \V_{\phi_2} f_2 \rangle = \langle f_1, f_2 \rangle \overline{\langle \phi_1, \phi_2 \rangle}
	\end{equation}
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
\begin{cor}
	If $f, \phi \in L^2(\R^d)$ then
	\begin{equation*}
		\| \V_{\phi} f\|_2 = \| f \|_2 \| \phi \|_2
	\end{equation*} 
	In particular if $\| \phi \|_2 = 1$ we see that $\V_{\phi}$ is an isometry from $L^2(\R^d)$ into $L^2(\R^{2d})$.
\end{cor}
\begin{proof}
	contenuto...
\end{proof}
From a direct computation one can see that the adjoint operator of the STFT operator $\V_{\phi}$ is given by the following expression:
\begin{equation}\label{STFT adjoint}
	\V_{\phi}^* g(t) = \int_{\R^{2d}} g(x,\omega) \phi(t-x) e^{2 \pi i \omega \cdot t} dxd\omega = \int_{\R^{2d}} g(x,\omega) M_{\omega}T_x \phi (t) dxd\omega\quad \forall g \in L^2(\R^{2d})
\end{equation}
This adjoint operator appears in the following nice property
\begin{teo}\label{inversion formula theorem}
	Let $f \in L^2(\R^d)$ and $\phi, \gamma \in L^2(\R^{2d})$ such that $\langle \phi, \gamma \rangle \neq 0$. Then:
	\begin{equation}\label{inversion formula}
		f(t) = \dfrac{1}{\langle \phi, \gamma \rangle} \V_{\gamma}^* \V_{\phi} f(t) = \dfrac{1}{\langle \phi, \gamma \rangle} \int_{\R^{2d}} \V_{\phi}f(x,\omega)M_{\omega}T_x \gamma (t) dxd\omega \quad \forall t \in \R^d
	\end{equation}
\end{teo}
\begin{proof}
	\textbf{VA MESSA??}
\end{proof}
Therefore the adjoint operator $\V_{\gamma}^*$ acts, in some sense, as an inverse operator. This will be of paramount importance in the following.
\begin{itemize}
	\item Relazione di ortogonalità
	\item Formula di inversione
\end{itemize}
\section{Bargmann Transform and Fock Space}\label{section Fock Space and Bargmann transform}
{\color{blue} Throughout this section we will consider the STFT with Gaussian window.} We choose
\begin{equation}\label{gaussian normalized}
	\varphi(x) = 2^{d/4} e^{-\pi |x|^2}
\end{equation}
where $|x|^2 = \sum_k^d x_k^2$ is the Euclidean norm of $x$ in $\R^d$. The factor $2^{d/4}$ is chosen so that $\|\varphi\|_2=1$. The STFT with Gaussian window becomes
\begin{equation}
	\V_{\varphi}f(x,\omega) = 2^{d/4} \int_{\R^d} f(t) e^{-\pi |t-x|^2} e^{-2 \pi i \omega \cdot t} dt
\end{equation}
{\color{red} Our aim now is to rearrange the terms in the above expression in order to make $z=x+i\omega \in \C^d$ appear. We want to highlight the fact that when talking about complex quantities $|z|^2 = z \overline{z} = |x|^2 + |\omega|^2$}.
\begin{align*}
	\V_{\varphi}f(x,\omega) &= 2^{d/4} \int_{\R^d} f(t) e^{-\pi |t|^2 + 2 \pi x \cdot t - \pi |\omega|^2} e^{ - 2 \pi i \omega \cdot t} dt\\
							&= 2^{d/4} \int_{\R^d} f(t) e^{-\pi |t|^2} e^{2 \pi (x - i \omega) \cdot t} e^{-\frac{\pi}{2}\left(|x|^2 - 2 i x \cdot \omega - |\omega|^2\right)} e^{-\frac{\pi}{2}\left(|x|^2 + |\omega|^2 + 2 i x \cdot \omega\right)}dt\\
							&= 2^{d/4} e^{-\pi i x \cdot \omega} e^{-\frac{\pi}{2}\left(|x|^2 + |\omega|^2\right)} \int_{\R^d} f(t) e^{-\pi |t|^2} e^{2 \pi (x-i\omega) \cdot t}e^{-\frac{\pi}{2}(x-i\omega)^2}dt
\end{align*}
The rearrangement may seem arbitrary but actually is done is such a way that inside the integral $x$ and $\omega$ enter only via $\overline{z}$.
\begin{defi}\label{Bargmann transform}
	The \textbf{Bargmann transform} of a function $f$ on $\R^d$ is the function $\Barg f$ on $\C^d$ given by
	\begin{equation}\label{Bargmann transform formula}
		\Barg f(z) = 2^{d/4} \int_{\R^d} f(t) e^{2 \pi t \cdot z - \pi |t|^2 - \frac{\pi}{2}z^2}dt
	\end{equation}
\end{defi}
We recall that a function defined over $C^d$ is \emph{entire} if it is holomorphic over all $\C^d$.
\begin{defi}\label{Fock space}
	The \textbf{Fock space} $\Fock^2(\C^d)$ is the Hilbert space of all entire functions $F$ on $\C^d$ for which the norm
	\begin{equation}\label{Fock space norm}
		\|F\|^2_{\Fock} = \int_{\C^d} |F(z)|^2 e^{-\pi |z|^2}dz
	\end{equation}
	is finite.
\end{defi}
Clearly the norm of the Fock space is induced by the following scalar product
\begin{equation}\label{Fock space scalar product}
	\langle F,G \rangle_{\Fock} \int_{\C^d} F(z) \overline{G(z)} e^{-\pi |z|^2}dz
\end{equation}
\begin{prop}
	If $f$ is a function on $\R^d$ with polynomial growth then its Bargmann transform $\Barg f$ is an entire function on $\C^d$. Moreover, letting $z = x + i\omega$, the Bargmann transform of $f$ is related to its STFT through the following
	\begin{equation}\label{connection between Bargmann transform and STFT}
		\V_{\varphi} f(x,-\omega) = e^{\pi i x \cdot \omega} \Barg f(z) e^{-\pi |z|^2/2}
	\end{equation}
\end{prop}
\begin{proof}
	contenuto...
\end{proof}
\begin{prop}
	If $f \in L^2(\R^d)$ then
	\begin{equation}
		\|f\|_2 = \left(\int_{\C^d} |\Barg f(z)|^2 e^{-\pi |z|^2}dz\right)^{1/2} = \|\Barg f\|_{\Fock}.
	\end{equation}
	Thus $\Barg$ is an isometry from $L^2(\R^d)$ into $\Fock^2(\C^d)$.
\end{prop}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Localization Operators}\label{chapter localization operators}
{\color{red}One of the main problems in signal analysis or, in general, time-frequency analysis is to extract some informations about signal in order to analyse it. We saw that STFT can be a tool for this purpose, however it has some practical problems: it doubles the dimension of the output and it is highly redundant.}\\
In this chapter we see two possible ways to deal with the problem of creating operators able to localize a signal both in time and frequency.
\section{Localization with projections}
The most straightforward way to localize a signal, say in the time domain, is to use a sharp cut-off, which means a characteristic function. If we suppose to have a signal $f \in L^2(\R^d)$ and we want to localize it in a measurable subset $T \subseteq \R^d$ of the time domain we can consider the natural projection operator
\begin{equation}\label{time projection operator}
	P_T : L^2(\R^d) \rightarrow L^2(\R^d) \quad P_T f(t) = \chi_T(t) f(t)
\end{equation}
This is clearly a projection operator, which means that $P_T^2 = P_T = P_T^*$.\\
In the same fashion we can define an operator able to localize on a measurable subset $\Omega \subseteq \R^d$ in the frequency domain. Their definition it is not as direct as the one for time projections but it is still easy to understand
\begin{equation}\label{frequency projection operator}
	Q_{\Omega} : L^2(\R^d) \rightarrow L^2(\R^d) \quad Q_{\Omega} f(t) = \F^{-1} \left(\chi_{\Omega} \F f \right)(t) = \int_{\Omega} \hat{f}(\omega) e^{2 \pi i \omega \cdot t} d\omega
\end{equation}
It is also quite simple to show that this is a projection operator
\begin{align*}
	&Q_{\Omega}^2 = \F^{-1} \chi_{\Omega} \F \F^{-1} \chi_{\Omega} \F = \F^{-1} \chi_{\Omega} \chi_{\Omega} \F = \F^{-1} \chi_{\Omega} \F = Q_{\Omega}\\
	&Q_{\Omega}^* = \left( \F^{-1} \chi_{\Omega} \F\right)^* = \F^* \chi_{\Omega}^* \left(F^{-1}\right)^* = \F^{-1} \chi_{\Omega} \F = Q_{\Omega}
\end{align*}
where we used the fact that the Fourier transform is a unitary operator on $L^2(\R^d)$, namely that $\F^* = \F^{-1}$.\\
Moreover, both operators have norm less or equal than 1, independently of $T$ and $\Omega$:
\begin{align*}
	&\| P_T f \|_{L^2(\R^d)} = \| f \|_{L^2(T)} \leq \| f \|_{L^2(\R^d)} \\
	&\| Q_{\Omega} f \|_{L^2(\R^d)} = \| \F^{-1} \chi_{\Omega} \F f\|_{L^2(\R^d)} \overset{\text{Plancherel}}{=} \| \F f\|_{L^2(\Omega)} \leq \| \F f \|_{L^2(\R^d)} \overset{\text{Plancherel}}{=} \| f \|_{L^2(\R^d)}
\end{align*}

After defining these projection operators we may think to combine them into a single operator
\begin{equation*}\label{composition of projections}
	Q_{\Omega} P_T, \; P_T Q_{\Omega} : L^2(\R^d) \rightarrow L^2(\R^d)
\end{equation*}
which hopefully is able to localize a signal both in time and frequency ``near'' to the set $T \times \Omega$.\\
It is clear that these operators are linear and bounded, in particular their norms are less or equal than 1.

Up to now the only (essential) hypothesis on $T$ and $\Omega$ is that they are measurable. Clearly, by adding some requirements on $T$ and $\Omega$ we expect $Q_{\Omega} P_T$ and $P_T Q_{\Omega}$ to gain some properties.
\begin{prop}\label{projection operators are Hilbert-Schmidt}
	Let $T,\Omega \subset \R^d$ with finite measure. Then $Q_{\Omega} P_T$ and $P_T Q_{\Omega}$ are Hilbert-Schmidt integral operators of the form
	\begin{align}
		Q_{\Omega} P_T f(x) &= \int_{\R^d} K(x,t) f(t) dt \\
		P_T Q_{\Omega} f(x) &= \int_{\R^d} \overline{K(t,x)}f(t)dt
	\end{align}
	where
	\begin{equation}\label{integral kernel projection operators}
		K(x,t) = \chi_T(t) \int_{\Omega} e^{2 \pi i \omega \cdot (x-t)}d\omega
	\end{equation}
	which has $\| K \|_{L^2(\R^{2d})} = \sqrt{|T||\Omega|}$.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}
If we compare the integral kernels of $Q_{\Omega} P_T$ and $P_T Q_{\Omega}$ we see that $K(x,t) \neq \overline{K(t,x)}$, hence, by proposition \ref{condition integral operator self-adjoint}, we immediately conclude that both operator are not self-adjoint. {\color{red} Since it is better to deal with self-adjoint operators when it comes to spectral properties, it would be nice if we could construct those starting from $Q_{\Omega} P_T$ and $P_T Q_{\Omega}$.} This is easily done by considering
\begin{align}
	(Q_{\Omega} P_T)^* Q_{\Omega} P_T &= P_T^* Q_{\Omega}^* Q_{\Omega} P_T= P_T Q_{\Omega} P_T\\
	(P_T Q_{\Omega})^* P_T Q_{\Omega} &= Q_{\Omega}^* P_T^* P_T Q_{\Omega} = Q_{\Omega} P_T Q_{\Omega}
\end{align} 
These are, by construction, self-adjoint operators, and since both $Q_{\Omega} P_T$ and $P_T Q_{\Omega}$ are compact operators (thanks to Proposition \ref{projection operators are Hilbert-Schmidt} and Theorem \ref{Hilbert-Schmidt operators are compact}) they are also compact (we recall that composition between a general operator and a compact one is compact). Hence, by Theorem \ref{self-adjoint compact operators are diagonalizable} they can be diagonalized.\\
{\color{red} Aggiungere qualcosa sulle prolate spheroidal wave functions?}


\section{Daubechies' localization operators}\label{Daubechies' localization operators section}
{\color{red} Projection operators considered in the previous section are powerful tools in signal analysis and quantum mechanics}. Nevertheless they treat time and frequency in a separate way. We already saw that a good tool to simultaneously study a signal in time and frequency is the STFT but we also pointed out its limits. {\color{red} However we can think to construct localization operators using the STFT instead of the Fourier transform}. This is exactly what was done by Ingrid Daubechies in 1988 in \cite{daubechies}. From Theorem \ref{inversion formula theorem} we know that the adjoint operator of $\V_{\phi}$ acts as inverse operator. If we choose a window $\phi \in L^2(\R^{2d})$ normalized, \ref{inversion formula} becomes
\begin{equation*}
	f(t) = \V_{\phi}^* \V_{\phi}f(t)
\end{equation*}
The key idea is to multiply $\V_{\phi} f$ by a \emph{weight function} $F(\omega,t)$, which logically should highlight some features of $\V_{\phi}f$ :
\begin{equation}\label{Daubechies' localization operator def}
	L_{F,\phi} : L^2(\R^d) \rightarrow L^2(\R^d) \quad L_{F,\phi}f(t) = \V_{\phi}^* F \V_{\phi} f(t)
\end{equation}
Related to this localization operator is the sesquilinear form $\L_{F,\phi} : L^2(\R^d) \times L^2(\R^d) \rightarrow \R$ defined by the expression
\begin{equation}\label{sesquilinear form localization operator}
	\L_{F,\phi}(f,g) = \int_{\R^{2d}} F(x,\omega) \V_{\phi}f(x,\omega) \overline{\V_{\phi}g(x,\omega)} dxd\omega
\end{equation}
Indeed, assuming $\L_{F,\phi}$ is bounded, we could define $ L_{F,\phi} f$ through Riesz' representation theorem as the only element of $L^2(\R^d)$ such that
\begin{equation}\label{L_F through duality}
	\L_{F,\phi}(f,g) = \langle L_{F,\phi}f,g \rangle  = \int_{\R^d} L_{F,\phi}f(t) \overline{g(t)}\quad \forall g \in L^2(\R^d)
\end{equation}
and therefore $L_{F,\phi}$ as the function which maps $f$ into its representation.\\
{\color{blue} QUESTA PARTE VA MESSA A POSTO IN MODO DA UNIFORMARE I RISULTATI}
\begin{prop}\label{F bounded L_F bounded}
	If $F \in L^{\infty}(\R^{2d})$ then $\| L_{F,\phi}\| \leq \| F \|_{\infty}$.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}
\begin{prop}\label{F integrable L_F bounded}
	If $F \in L^1(\R^{2d})$ then $\| L_{F,\phi}\| \leq \| F \|_1$.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}
Thanks to these result and an interpolation argument one can show that $\L_{F,\phi}$, and hence $L_{F,\phi}$, is bounded also when $F \in L^p(\R^{2d})$ for $1 < p < \infty$. A proof can be found in \cite{wong}, Proposition 12.3.
\begin{prop}\label{F in Lp L_F bounded}
	Let $F \in L^p(\R^{2d})$ for $1 < p < \infty$. Then there exist a unique bounded linear operator $L_{F,\phi} : L^2(\R^d) \rightarrow L^2(\R^d)$ such that $L_{F,\phi} f$ is given by \eqref{L_F through duality} for all $f \in L^2(\R^d)$ and all simple functions $F$ for which $|\{F(x) \neq 0\}| < \infty$. Moreover, the application that maps $F$ into $L_{F,\phi}$ is bounded.
\end{prop}
{\color{blue} Since simple functions supported on a set of finite measure are dense in $L^p(\R^{2d})$, through dominated convergence we can conclude that \eqref{sesquilinear form localization operator} holds for every $F \in L^p(\R^{2d})$.}
\begin{itemize}
	\item Definizione
	\item Operatori di proiezione
	\item Operatori di localizzazione di Daubechies
	\item Proprietà di limitatezza e compattezza
	\item Autovalori e autofunzioni
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Uncertainty principles}\label{chapter uncertainty principles}
In previous chapters sometimes we wrote about ``good'' and ``bad'' localization of a signal. Although intuitively this can be understood in these sloppy terms, we can specify and quantify the localization of a function. The notion of localization can be stated in multiple ways and in various contexts. {\color{blue} Here we present some \emph{uncertainty principles}.}
\section{Heisenberg's uncertainty principle}\label{section Heisenberg's UP}
\begin{lem}\label{uncertainty principle for operators lemma}
	Let $A$ and $B$ be two linear self-adjoint (possibly unbounded) operators on a Hilbert space. Then, for every $a,b \in \R$ and for every $f$ in the domain of $AB$ and $BA$
	\begin{equation}\label{uncertainty principle for operators formula}
		\| (A-a)f \| \cdot \| (B-b) f\| \geq \dfrac12\lvert\langle [A,B]f,f \rangle \rvert
	\end{equation}
	where $[A,B] = AB-BA$ is the commutator of $A$ and $B$. Equality holds if and only if $(A-a)f = i c(B-b)f$ for some $c \in \R$.
\end{lem}
\begin{proof}
	contenuto...
\end{proof}

\begin{teo}[Heisenberg's uncertainty principle]\label{Heisenberg's uncertainty principle theorem}
	If $f \in L^2(\R^d)$, for every $a,b \in \R^d$
	\begin{equation}\label{Heisenberg's uncertainty principle formula}
		\left(\int_{\R^d}|t-a|^2 |f(t)|^2 dt\right)^{1/2} \left(\int_{\R^d} |\omega-b|^2 |\hat{f}(\omega)|^2 d\omega\right)^{1/2} \geq \dfrac{d}{4\pi}\| f \|_2^2
	\end{equation}
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
For a generic function $f \in L^2(\R^d)$ the left-hand side of \eqref{Heisenberg's uncertainty principle formula} may be infinite, in which case the statement is trivially satisfied. {\color{blue}We shall comment a mathematical interpretation of Heisenberg's uncertainty principle. This can be written in the following form
\begin{equation*}
	\left(\int_{\R^d}|t-a|^2 \dfrac{|f(t)|^2}{\|f\|_2^2} dt\right)^{1/2} \left(\int_{\R^d} |\omega-b|^2 \dfrac{|\hat{f}(\omega)|^2}{\|\hat{f}\|_2^2}d\omega\right)^{1/2} \geq \dfrac{d}{4\pi}
\end{equation*}
so we may directly assume that $f$ is normalized. In such a case $|f|^2$ can be seen as a probability distribution. If these integrals are finite for some $a$ and $b$ are always finite and their minimum is achieved when
\begin{equation*}
	a = \bar{t} = \int_{\R^d} t |f(t)|^2 dt, \quad b = \bar{\omega} = \int_{\R^d} \omega |\hat{f}(\omega)|^2 d\omega
\end{equation*}
which are the mean of $|f|^2$ and $|\hat{f}|^2$, respectively. In this case previous integrals represent the standard deviation of $|f|^2$ and $|\hat{f}|^2$, which we indicate with $\Delta_x f$ and $\Delta_{\omega} f$. It is fair to believe that a function $|f|^2$ is mostly concentrated around its mean and that its standard deviation is a measure of how spread it is. In light of these arguments, Heisenberg's uncertainty principle can written as
\begin{equation*}
	\Delta_x f \cdot \Delta_{\omega} f \geq \dfrac{d}{4\pi}
\end{equation*}
In this form the uncertainty principle has a heuristic yet meaningful interpretation:\\
\emph{a function and its Fourier transform can not be simultaneously too concentrated}.\\
\textbf{AGGIUNGERE INTERPRETAZIONI IN MECCANICA QUANTISTICA E ANALISI DEI SEGNALI}.}
\section{Donoho-Stark's uncertainty principle}\label{section Donoho-Stark's UP}
\begin{defi}\label{epsilon-concetrated def}
	A function $f \in L^2(\R^d)$ is $\mathbf{\varepsilon}$-\textbf{concetrated} on a measurable set $T \subseteqq \R^d$ if
	\begin{equation*}
		\left(\int_{\R^d \setminus T} |f(t)|^2 dt \right) \leq \varepsilon \| f \|_2
	\end{equation*}
\end{defi}
\begin{teo}[Donoho-Stark's uncertainty principle]\label{Donoho-Stark's uncertainty principle theorem}
	Let $f \in L^2(\R^d) \setminus \{0\}$, suppose that $f$ is $\varepsilon_T$-concentrated on $T \subseteqq \R^d$ while $\hat{f}$ is $\varepsilon_{\Omega}$-concentrated on $\Omega \subseteqq \R^d$. Then
	\begin{equation}\label{Donoho-Stark's uncertainty principle formula}
		|T| \cdot |\Omega| \geq (1 - \varepsilon_T - \varepsilon_{\Omega})^2
	\end{equation}
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
\section{Lieb's uncertainty principle}\label{section Lieb's UP}
\begin{prop}\label{weak uncertainty principle fot STFT}
	Let $f,\phi \in L^2(\R^d)$ normalized, $U \subseteqq \R^{2d}$ and $\varepsilon \geq 0$. Suppose that
	\begin{equation*}
		\int_U |\V_{\phi}f(x,\omega)|^2 dxd\omega \geq 1- \varepsilon.
	\end{equation*}
	Then $|U| \geq 1- \varepsilon$.
\end{prop}
\begin{proof}
	contenuto...
\end{proof}
\begin{teo}
	If $f,\phi \in L^2(\R^d)$ and $2 \leq p \leq \infty$, then
	\begin{equation}\label{norm Lp STFT}
		\int_{\R^{2d}} |\V_{\phi}(x,\omega)|^p dxd\omega \leq \left(\dfrac{2}{p}\right)^d \|f\|_2^p \cdot \|g\|_2^p
	\end{equation}
\end{teo}
\begin{proof}
	contenuto...
\end{proof}
\begin{teo}[Lieb's uncertainty principle]\label{Lieb's uncertainty principle}
	Suppose that $\|f\|_2 = \|\phi\|_2 = 1$. If $U \subseteqq \R^{2d}$ and $\varepsilon \geq 0$ are such that
	\begin{equation*}
		\int_U |\V_{\phi}f(x,\omega)|^2 dxd\omega \geq 1- \varepsilon.
	\end{equation*}
	Then
	\begin{equation*}\label{Lieb's uncertainty principle formula}
		|U| \geq (1-\varepsilon)^{\frac{p}{p-2}} \left(\dfrac{p}{2}\right)^{\frac{2d}{p-1}} \quad \text{for every } p>2.
	\end{equation*}
\end{teo}


section Faber-Krahn inequality fot STFT\section{Nicola-Tilli's uncertainty principle or Faber-Krahn Inequality for the STFT}\label{section Faber-Krahn inequality fot STFT}
Theorem from \cite{nicolatilli_fk}
\begin{teo}\label{faberkrahn theorem}
	For every $f \in L^2(\R^d)$ such that $\|f\|_{L^2} = 1$ and every measurable subset $\Omega \subset \R^{2d}$ with finite measure we have
	\begin{equation*}
		\int_{\Omega}  |\V f(x,\omega)|^2 \dxdo \leq G(|\Omega|)
	\end{equation*}
	where $G(s)$ is given by
	\begin{equation}\label{G}
		G(s) \coloneqq \int_0^s e^{\left(-d!\tau\right)^{1/d}} d\tau
	\end{equation}
	Moreover, equality occurs if and only if $f$ is a Gaussian of the kind
	\begin{equation}\label{translated Gaussian}
		f(x) = c e^{2 \pi x \cdot \omega_0} \varphi(x-x_0) \quad x \in \R^d
	\end{equation}
	for some unimodular $c \in \C$ and some $(x_0,\omega_0) \in  \R^{2d}$ and $\Omega$ is equivalent, in measure, to a ball of centre $(x_0,\omega_0)$.
\end{teo}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Recent results}\label{chapter recent results}
\section{Norm of localization operators: results from Nicola-Tilli}\label{section norm of localization operators}
{\color{blue}In Section \ref{Daubechies' localization operators section} we obtained some basic results for the norm of Daubechies' localization operators, independently of the choice of the window $\phi$ for the STFT. It is reasonable to think that, for specific windows those estimates can be improved and, hopefully, find some sharp bounds. Thanks to \ref{faberkrahn theorem} Nicola and Tilli accomplished this task in the case the window of the STFT is a normalized Gaussian. As done previously, since the windows is fixed one for all we will drop the pedex $\phi$.}

As for the results in Section \ref{Daubechies' localization operators section}, assumptions on the weight function $F$ are related to its integrability and boundedness. The problem we are consider is, in fact, finding an optimal estimate of the type
\begin{equation}\label{sharp estimate Nicola-Tilli}
	\|L_F\|_{L^2(\R^d) \rightarrow L^2(\R^d)} \leq C
\end{equation}
where $F$ satisfies the following constraints:
\begin{equation}\label{constraints Nicola-Tilli}
	\|F\|_p \leq A \quad \text{and} \quad \|F\|_{\infty} \leq B.
\end{equation}
Clearly the constant $C$ will depend on $p$, $A$ and $B$. In \cite{nicolatilli_norm} this problem is completely solved: the constant $C$ is computed (explicitly in some cases), weight functions $F$ which achieve this bound are explicitly found and also function $f$ and $g$ such that $|\langle L_f f, g \rangle| = \|L_F\| = C$ are found. Before reporting the main Theorem in \cite{nicolatilli_norm}, we define the following number which will appear many times in the following
\begin{equation}\label{kappa_p}
	\kappa_p \coloneqq \dfrac{p-1}{p}.
\end{equation}
\begin{teo}\label{Nicola Tilli norm theorem}
	Assume $p \in [1,\infty)$, $A \in (0, \infty]$ and $B \in (0,\infty)$ with the additional condition that $A < \infty$ when $p=1$. Let $F$ satisfy the constraints in \eqref{constraints Nicola-Tilli}.
	\begin{enumerate}[label=(\roman*)]
		\item If $p=1$, then
		\begin{equation}\label{Nicola-Tilli bound p=1}
			\|L_F\| \leq A\;G(B/A)
		\end{equation}
		and equality occurs if and only if, for some $\theta \in \R$ and some $z_0 \in \R^{2d}$
		\begin{equation}\label{Nicola-Tilli maximal function p=1}
			F(z) = A e^{i\theta} \chi_{\mathdutchcal{B}} (z-z_0) \quad \forall z \in \R^{2d}
		\end{equation}
		where $\mathdutchcal{B} \subset \R^{2d}$ is the ball of measure $B/A$ centred at the origin.
		
		\item If $p>1$ and $\frac{B}{A} \leq \kappa_p^{d/p}$, then
		\begin{equation}\label{Nicola-Tilli bound p>1 first regime}
			\|L_F\| \leq \kappa_p^{d \kappa_p}B,
		\end{equation}
		with equality if and only if, for some $\theta \in \R$ and some $z_0 \in \R^{2d}$,
		\begin{equation}\label{Nicola-Tilli maximal function p>1 first regime}
			F(z) = e^{i \theta} \lambda e^{\frac{\pi}{p-1}|z-z_0|^2} \quad \forall z \in \R^{2d}
		\end{equation}
		where $\lambda = \kappa_p^{-d/p}B$.
	
		\item If $p>1$ and $\frac{B}{A} > \kappa_p^{d/p}$, then
		\begin{equation}\label{Nicola-Tilli bound p>1 second regime}
			\|L_F\| \leq \int_{0}^{A} G(u_{\lambda}(t))dt,
		\end{equation}
		where $u_{\lambda}(t) = \left[-\log\left(\left(\frac{t}{\lambda}\right)^{p-1}\right) \right]^d$ and $\lambda>A$ is uniquely determined by the condition $p\int_{0}^{A} t^{p-1}u_{\lambda}(t)dt = B^p$. Equality in \eqref{Nicola-Tilli bound p>1 second regime} if and only if, for some $\theta \in \R$ and some $z_0 \in \R^{2d}$,
		\begin{equation}\label{Nicola-Tilli maximal function p>1 second regime}
			F(z) = e^{i\theta} \min \{ \lambda e^{-\frac{\pi}{p-1}|z-z_0|^2}, A \}
		\end{equation}
	\end{enumerate}
	Finally, in all the cases, condition $|\langle L_F f,g \rangle| = \|L_F\|$ holds for some, $f,g \in L^2(\R^d)$ such that $\|f\|_2 = \|g\|_2 = 1$, if and only if both $f$ and $g$ are of the kind \eqref{translated Gaussian}, possibly with different $c$'s, but with the same $(x_0,\omega_0) \in \R^{2d}$ which coincides with the centre of $F$.
\end{teo}



\section{Generic case}
In this Section we will deal with a generalized version of the problem considered in \cite{nicolatilli_norm}. We want to find the optimal constant $C$ such that
\begin{equation*}
	\| L_F \|_{L^2(\R^d) \rightarrow L^2(\R^d)} \leq C
\end{equation*}
under the following constraints on $F$:
\begin{equation}\label{constraints generic case}
	\|F \|_p \leq A \quad \text{and} \quad \|F\|_q \leq B.
\end{equation}
where $p,q \in (1,\infty)$ and $A,B \in (0,\infty)$. In this setting it is no more possible to find an explicit expression for $C$ and $F$, {\color{red} although they can be easily computed numerically.}

Before tackling the problem, we prove a Theorem from \cite{nicolatilli_norm} which gives a bound for $\| L_F \|$ in terms of the distribution function of $|F|$.
\begin{teo}\label{norm limitation}
	Assume $F \in L^p(\R^{2d})$ for some $p \in [1,+\infty)$ and let $\mu(t) = |\{|F|>t\}|$ be the distribution function of $|F|$. Then
	\begin{equation}\label{norm limitation formula}
		\| L_F \| \leq \int_0^{\infty} G(\mu(t))dt
	\end{equation}
	Equality occurs if and only if $F(z)=e^{i\theta}\rho(|z-z_0|)$ for some $\theta \in \R$, $z_0 \in \R^{2d}$ and some nonincreasing function $\rho : [0,+\infty) \rightarrow [0,+\infty)$
\end{teo}
\begin{proof}
	For the sake of brevity we denote the variable $(x,\omega) \in R^{2d}$ as $z$ and therefore $dxd\omega$ as $dz$. Let $f,g \in L^2(\R^d)$ such that $\| f \|_2 = \| g \|_2 = 1$.
	{\color{blue} Since we are in a Hilbert space $\| L_F \|$ can be computed as the supremum of $|\langle L_F f,g \rangle|$ over all normalized $f$ and $g$. Therefore we are interested in estimating the previous scalar product}
	\begin{equation}\label{first inequality}
	\begin{aligned}
		| \langle L_F f, g \rangle |  &= | \L_{F}(f,g) | \leq \int_{\R^{2d}} |F(z)| \cdot |\V f(z)| \cdot | \V g(z) | dz \overset{\text{C-S}}{\leq} \\
									  &\leq \left( \int_{\R^{2d}} |F(z)| \cdot |\V f(z)|^2 dz \right)^{1/2} \left( \int_{\R^{2d}} |F(z)| \cdot |\V g(z)|^2 dz \right)^{1/2} 
	\end{aligned}
	\end{equation}
	Since the result is symmetric in $f$ and $g$ we can study just one of the terms. Letting $m = \esssup |F(z)|$ and assuming $m>0$ (otherwise every result is trivial) we can use the ``layer cake'' representation \cite[][Theorem 1.13]{liebloss}:
	\begin{equation*}
		|F(z)| = \int_0^m \chi_{\{|F|>t\}}(z)dt 
	\end{equation*}
	in order to find
	\begin{align*}
		\int_{\R^{2d}} |F(z)| \cdot |\V f(z)|^2 dz &= \int_{\R^{2d}} \left( \int_0^m \chi_{\{|F|>t\}}(z)dt \right) |\V f(z)|^2 dz \overset{\text{Tonelli}}{=}\\
											 &= \int_0^m \left( \int_{\R^{2d}} \chi_{\{|F|>t\}}(z) |\V f(z)|^2 dz \right)dt = \int_0^m \left( \int_{\{|F|>t\}} |\V f(z)|^2 dz \right)dt
	\end{align*}
	We notice that the quantity in the inner integral is exactly the one in the theorem \ref{faberkrahn theorem}, hence
	\begin{equation}\label{limitation with G}
		\int_{\R^{2d}} |F(z)| \cdot |\V f(z)|^2 dz \leq \int_0^m G\left(|\{|F|>t\}|\right)dt = \int_0^m G(\mu(t)) dt
	\end{equation}
	We point out that since $\mu(t) = 0$ for $t > m$ and that $G(0)=0$, the previous expression is equivalent to \eqref{norm limitation formula}.
	
	{\color{red} Because $p<\infty$, $L_F$ is a compact operator}, there exist normalized $f$ and $g$ which achieve equality in the supremum of the norm, namely $\langle L_F f, g \rangle = \| L_F \|$. Therefore equality in \eqref{norm limitation formula} occurs if and only if all the previous inequalities become equalities. Equality in \eqref{limitation with G} occurs if and only if
	\begin{equation}\label{first equality}
		\int_{\{|F|>t\}} |\V f(z)|^2 dz = G(\mu(t))
	\end{equation}
	for a.e. $t \in (0,m)$. Thanks to Theorem \ref{faberkrahn theorem}, for just one $t_0 \in (0,m)$ we can infer that $\{|F|>t_0\}$ is (equivalent to) a ball centred in $z_0 = (x_0,\omega_0)$ and that $f$ is a Gaussian of the kind \eqref{translated Gaussian} with the same centre $z_0$. Then, still by theorem \ref{faberkrahn theorem}, since \eqref{first equality} holds a.e in $(0,m)$ and that $f$ is always the same we have that also the other levels sets $\{|F|>t\}$ are equivalent to balls centred at the same $z_0$. Finally, we can extend the result to every $t \in (0,m)$ because $\{|F|>t\} = \bigcup_{s > t} \{|F|>s\}$. Since Theorem \ref{faberkrahn theorem} is a ``if and only if'', these conditions on $F$ and $f$ are also sufficient to guarantee equality in \eqref{limitation with G}. Clearly the same result holds for $g$ which has to be a Gaussian, possibly with different coefficient $c$ but the same centre.
	
	In the end it turns that $|F|$ is spherically symmetric and radially decreasing as claimed in theorem's statement.
	
	Conditions for $f$ and $g$ imply that $\V g  = e^{i \alpha} \V f$ for some $\alpha \in \R$. This provides equality in \eqref{first inequality} when using Cauchy-Schwartz inequality. Lastly we shall prove that also the first inequality in \eqref{first inequality}, that is
	\begin{equation*}
		\left\vert \int_{\R^{2d}} F(z) \V f(z) \overline{\V g(z)} dz \right\vert \leq \int_{\R^{2d}} |F(z)| \cdot | \V f(z)| \cdot |\V g(z)| dz
	\end{equation*}
	becomes an equality, which is true if and only if
	\begin{equation*}
		e^{-i\theta}  \int_{\R^{2d}} F(z) \cdot |\V f(z)|^2 dz = \int_{\R^{2d}} |F(z)| \cdot | \V f(z)|^2 dz
	\end{equation*}
	for some $\theta \in \R$. This, in turn, is equivalent to the condition
	\begin{equation*}
		e^{-i \theta}F(z) \cdot |\V f(z)|^2 = |F(z)| \cdot |\V f(z)|^2 \quad \text{for a.e. } z \in \R^{2d}
	\end{equation*}
	but since $|\V f(z)|^2 > 0$, equality in \ref{first inequality} with $f$ and $g$ as \textbf{METTERE A POSTO} occurs if and only if $F(z) = e^{i \theta} |F(z)|$.
\end{proof}







Let's now consider the case where both $p$ and $q$ are neither 1 or $+\infty$. The result presented in \cite{nicolatilli_norm} include the case ...
\begin{equation*}
	\| L_F\|_{L_2 \rightarrow L_2} \leq \min\{\kappa_p^{d\kappa_p}A, \, \kappa_q^{d\kappa_q}B\}
\end{equation*}
Suppose that the minimum is given by $\kappa_p^{d\kappa_p}A$, therefore
\begin{equation*}
	\kappa_p^{d\kappa_p}A \leq \kappa_q^{d\kappa_q}B \iff \dfrac{B}{A} \geq \left(\dfrac{\kappa_p^{\kappa_p}}{\kappa_q^{\kappa_q}}\right)^d
\end{equation*}
We can check if the solution of the problem with just the $L^p$ bound solves also the problem with both bounds, that is $F\|_{L^q} \leq B$, where $F$ is given by ...
\begin{align*}
	\| F \|_{L^q}^q &= \int_{\R^{2d}} |F(z)|^q dz = ... = \lambda^q \left(\dfrac{p-1}{q}\right)^d
\end{align*}
Since we want $F$ to satisfy the $L^q$ constraint we should have
\begin{equation*}
	\dfrac{B}{A} \geq \kappa_p^{d\left(\frac1q - \frac1p\right)}\left(\dfrac{p}{q}\right)^{\frac{d}{q}}
\end{equation*}
It would be nice if this bound was less restrictive than the first one. Unfortunately that's not the case, in fact it's always true that
\begin{equation*}
	\left(\dfrac{p'}{q'}\right)^{\frac1{q'}} \left(\dfrac{p}{q}\right)^{\frac1q} \geq 1
\end{equation*}

Following the path in \cite{nicolatilli_norm} we obtain ...\\
\begin{equation*}
	G'(u(t)) = \lambda_1 t^{p-1} + \lambda_2 t^{q-1} \implies u(t) = \dfrac{1}{d!}\left[-\log\left(\lambda_1 t^{p-1} + \lambda_2 t^{q-1}\right)\right]^d, \ t \in (0,M)
\end{equation*}
Our main goal now is to show that multipliers $\lambda_1, \lambda_2$ are unique and both positive.

The easiest fact to prove is that both multipliers are not 0. In fact if one, say $\lambda_2$, was 0, we would obtain that the solution of our problem is the same as the one with just the $L^p$ bound. But we already know that this function does not satisfy the $L^q$ constraint hence it is impossible that $\lambda_2=0$.

Suppose now that one of the multipliers, say always $\lambda_2$, is negative. Consider an interval $[a,b] \subset (0,M)$ and a variation $\eta \in L^{\infty}(0,M)$ supported in $[a,b]$. Thanks to the Gram-Schmidt process we can construct a variation orthogonal to $t^{p-1}$. Since $\eta$ is arbitrary we can suppose that it is not orthogonal to $t^{q-1}$, in particular we can suppose that $\int_{a}^{b}t^{q-1}\eta(t)dt <0$. Therefore the directional derivative of $G$ along $\eta$ is:
\begin{align*}
	\int_{a}^{b} G'(u(t))\eta(t)dt &= \int_{a}^{b} (\lambda_1 t^{p-1} + \lambda_2 t^{q-1})\eta(t)dt = \\
									   &= \lambda_2 \int_{a}^{b} t^{q-1} \eta(t)dt > 0
\end{align*}
which contradicts the fact that $u$ is a maximizer.

Now that we now that both multipliers are positive we can prove that $u$ is continuous, which is equivalent to say that $M=T$, where $T$ is the unique positive number such that $\lambda_1 T^{p-1} + \lambda_2 T^{q-1} = 1$ (uniqueness of $T$ follows from the positivity of multipliers).\\
We start supposing that $M < T$ which means that $\lim_{t \rightarrow M^-} u(t) > 0$. Consider the following variation 
\begin{equation*}
	\eta(t) = \left\{
	\begin{aligned}
		-1 + \alpha \frac{t}{M} + \beta,\quad & t \in (M-M\delta,M)\\
		1,\quad					   & t \in (M,M+M\delta)\\
		0,\quad				   & \text{otherwise}
	\end{aligned}\right.
\end{equation*}
where $\delta>0$ is small enough so that $M-M\delta >0$ and $M+M\delta < T$ while $\alpha$ and $\beta$ are constants, depending on $\delta$, to be found. Since we want this to be an admissible variation we need to impose that $\eta$ is orthogonal to $t^{p-1}$ and $t^{q-1}$. For example, the first condition is:
\begin{align*}
	0 &= \int_{M-M\delta}^{M+M\delta} t^{p-1} \eta(t) dt = -\int_{M-M\delta}^M t^{p-1}dt + \int_{M-M\delta}^M t^{p-1}\left(\alpha \frac{t}{M} + \beta\right) dt + \int_M^{M+M\delta} t^{p-1}dt \overset{\tau=t/M}{=}\\
	  &= M^p \int_{1-\delta}^1 \tau^{p-1}(\alpha \tau + \beta) d\tau - M^p \int_{1-\delta}^1 \tau^{p-1} d\tau + M^p \int_1^{1+\delta} \tau^{p-1} d\tau \overset{1/\delta}{\implies}\\
	  &\implies \fint_{1-\delta}^1 \tau^{p-1}(\alpha \tau + \beta) d\tau = \alpha \fint_{1-\delta}^1 \tau^{p} d\tau + \beta \fint_{1-\delta}^1 \tau^{p-1} d\tau = \fint_{1-\delta}^1 \tau^{p-1} d\tau - \fint_1^{1+\delta} \tau^{p-1} d\tau 
\end{align*}
The equation stemming from the orthogonality with $t^{q-1}$ is analogous. Therefore we obtained a nonhomogeneous linear system for $\alpha$ and $\beta$
\textbf{VA RESO MEGLIO}
\begin{equation}\label{system continuity}
	\begin{pmatrix}
		\fint_{1-\delta}^1 \tau^{p} d\tau &  \fint_{1-\delta}^1 \tau^{p-1} d\tau\\
		\fint_{1-\delta}^1 \tau^{q} d\tau & \fint_{1-\delta}^1 \tau^{q-1} d\tau
	\end{pmatrix}
	\begin{pmatrix}
		\alpha\\
		\beta
	\end{pmatrix}=
	\begin{pmatrix}
		\fint_{1-\delta}^1 \tau^{p-1} d\tau - \fint_1^{1+\delta} \tau^{p-1} d\tau\\
		\fint_{1-\delta}^1 \tau^{q-1} d\tau - \fint_1^{1+\delta} \tau^{q-1} d\tau
	\end{pmatrix}
\end{equation}
This system has a unique solution if and only if the determinant of the matrix is not 0. We can show this directly:
\begin{align*}
	& \fint_{1-\delta}^1 \tau^{p} d\tau \fint_{1-\delta}^1 \tau^{q-1} d\tau - \fint_{1-\delta}^1 \tau^{q} d\tau \fint_{1-\delta}^1 \tau^{p-1} d\tau=\\
	&= \dfrac{1}{\delta^2} \int_{(1-\delta,1)^2} \left(\tau^p \sigma^{q-1} - \tau^{p-1}\sigma^q\right) d\tau d\sigma = \dfrac{1}{\delta^2} \int_{(1-\delta,1)^2} \tau^{p-1} \sigma^{q-1} \left( \tau - \sigma \right) d\tau d\sigma = \\
	&= \dfrac{1}{\delta^2} \left( \int_{Q_1} \tau^{p-1} \sigma^{q-1} \left( \tau - \sigma \right) d\tau d\sigma + \int_{Q_2} \tau^{p-1} \sigma^{q-1} \left( \tau - \sigma \right) d\tau d\sigma \right)=
\end{align*}
where $Q_1=(1-\delta,1)^2 \cap \{\tau > \sigma\}$ and $Q_2=(1-\delta,1)^2 \cap \{\tau < \sigma\}$. In the second integral we can consider the change of variable that swaps $\tau$ and $\sigma$. In this case the new domain is $Q_1$, hence:
\begin{align*}
	= \dfrac{1}{\delta^2} \int_{Q_1} \left(\tau^{p-1}\sigma^{q-1} - \tau^{q-1}\sigma^{p-1}\right) \left(\tau - \sigma\right) d\tau d\sigma
\end{align*}
In $Q_1$ $\tau - \sigma > 0$ and the sign of $\tau^{p-1}\sigma^{q-1} - \tau^{q-1}\sigma^{p-1}$ is constant, in fact:
\begin{equation*}
	\tau^{p-1}\sigma^{q-1} - \tau^{q-1}\sigma^{p-1} > 0 \iff \left(\dfrac{\tau}{\sigma}\right)^{p-q} > 1 \overset{\tau > \sigma}{\iff} p>q
\end{equation*}
Therefore the determinant of the matrix is always non 0.\\
%If we see it as a function of $\delta$ we can expand the terms in a Taylor series:
%\begin{align*}
%	& \fint_{1-\delta}^1 \tau^{p} d\tau \fint_{1-\delta}^1 \tau^{q-1} d\tau - \fint_{1-\delta}^1 \tau^{q} d\tau \fint_{1-\delta}^1 \tau^{p-1} d\tau=\\
%	&=\left(1-\dfrac{p}{2}\delta + \dfrac{p(p-1)}{6}\delta^2 + o(\delta^2)\right) \left(1-\dfrac{q-1}{2}\delta + \dfrac{(q-1)(q-2)}{6}\delta^2 + o(\delta^2)\right) +\\
%	&-\left(1-\dfrac{q}{2}\delta + \dfrac{q(q-1)}{6}\delta^2 + o(\delta^2)\right) \left(1-\dfrac{p-1}{2}\delta + \dfrac{(p-1)(p-2)}{6}\delta^2 + o(\delta^2)\right)=\\
%	&=(1-1) + \delta \left(-\dfrac{q-1}{2} - \dfrac{p}{2} + \dfrac{p-1}{2} + \dfrac{q}{2} \right) \ldots\\
%	&=\dfrac{p-q}{12}\delta^2 + o(\delta^2)
%\end{align*}
%therefore the determinant is always non 0.\\
The derivative of $G$ along $\eta$ is nonpositive because $u$ is supposed to be a maximizer, therefore
\begin{align*}
	0 &\geq \int_{M-M\delta}^{M+M\delta} G'(u(t))\eta(t)dt = -\int_{M-M\delta}^M \left(\lambda_1 t^{p-1} + \lambda_2 t^{q-1}\right) dt\, +\\
	  &+ \int_{M-M\delta}^M \left(\lambda_1 t^{p-1} + \lambda_2 t^{q-1}\right)\left(\alpha \dfrac{t}{M}+\beta\right) dt + \int_M^{M+M\delta}dt = \\
	  &= -\int_{M-M\delta}^M \left(\lambda_1 t^{p-1} + \lambda_2 t^{q-1}\right) dt + \lambda_1 M^p \int_{1-\delta}^1 t^{p-1}(\alpha t + \beta) dt +\\
	  &+ \lambda_2 M^q \int_{1-\delta}^1 t^{q-1}(\alpha t + \beta) dt + M\delta
\end{align*}
Dividing by $M\delta$ and rearranging we obtain:
\begin{equation}\label{inequality continuity}
	\fint_{M-M\delta}^M \left(\lambda_1 t^{p-1} + \lambda_2 t^{q-1}\right) dt \geq  1 + \lambda_1 M^{p-1} \fint_{1-\delta}^1 t^{p-1}(\alpha t + \beta) dt\, + \lambda_2 M^{q-1} \fint_{1-\delta}^1 t^{q-1}(\alpha t + \beta) dt
\end{equation}
We notice that the last two terms are exactly the one that appear in the orthogonality condition, therefore to understand their behavior as $\delta$ approaches 0 we need to study the right-hand side of the system \eqref{system continuity}. If we expand the first term in its Taylor series with respect to $\delta$ we have:
\begin{align*}
	\left(1-\dfrac{p-1}{2}\delta + o(\delta) \right) - \left(1+\dfrac{p-1}{2}\delta + o(\delta) \right) = -(p-1)\delta + o(\delta)
\end{align*}
and the same is for the other term. Since they both are of order $\delta$ if we let $\delta \rightarrow 0^+$ in \eqref{inequality continuity} we obtain
\begin{equation*}
	\lambda_1 M^{p-1} + \lambda_2 M^{q-1} \geq 1
\end{equation*}
Since the function $\lambda_1 t^{p-1}  + \lambda_2 t^{q-1}$ is strictly increasing (because $\lambda_1$ and $\lambda_2$ are both positive) $M \geq T$ which is absurd because we supposed that $M<T$.

Lastly we shall prove that multipliers $\lambda_1, \lambda_2$, and hence maximizer, are unique. For this proof it is convenient to express $u$ in a slightly different way:
\begin{equation*}
	u(t) = \dfrac{1}{d!}\left[ \Log\left((c_1t)^{p-1} + (c_2t)^{q-1}\right) \right]^d
\end{equation*} 
To emphasize that $u$ is parametrized by $c_1, c_2$ we may write $u(t;c_1,c_2)$. Now we define
\begin{equation*}
	f(c_1,c_2) = p\ \int_0^T t^{p-1}u(t;c1,c2)dt, \quad g(c_1,c_2) = q\ \int_0^T t^{q-1}u(t;c1,c2)dt
\end{equation*}
We want to highlight that, even if not explicit, also $T$ depends on $c_1$ and $c_2$. Nevertheless these functions are differentiable since both $T$ and $u$ are differentiable with respect to $(c_1,c_2)$, functions $t^{p-1}u$ and $t^{q-1}u$ and their derivatives are bounded in $(0,T)$. 
Our maximizer $u$ satisfies the constraints only if $f(c_1,c_2)=A^p, \, g(c_1,c_2) = B^q$. Therefore to prove uniqueness of the maximizer we need to show that level sets $\{f=A^p\}$ and $\{g=B^q\}$ intersect in only a point.\\
First of all we are studying endpoints. For example, if $c_2=0$:
\begin{align*}
	f(c_1,0) &= p\int_0^{1/{c_1}} t^{p-1}\dfrac{1}{d!}\left[-\log(c_1t)^{p-1}\right]^d dt \overset{\tau = c_1t}{=} \\
			 &= \dfrac{p(p-1)^d}{c_1^p d!}\int_0^1 \tau^{p-1}\left[-\log(\tau)\right]^d d\tau = \dfrac{\kappa_p^d}{c_1^p} = A^p \implies c_{1,f} = \dfrac{\kappa_p^{d/p}}{A}
\end{align*}
The same can be done for $g$ and setting $c_1=0$ thus we obtain four points
\begin{equation*}
	c_{1,f} = \dfrac{\kappa_p^{d/p}}{A},\ c_{1,g} = \left(\dfrac{p-1}{q}\right)^{d/q}\dfrac1{B},\ c_{2,f} = \left(\dfrac{q-1}{p}\right)^{d/p}\dfrac1{A},\ c_{2,g} = \dfrac{\kappa_q^{d/q}}{B}
\end{equation*}
In the regime we are considering one has that $c_{1,f} < c_{1,g}$ and $c_{2,f} > c_{2,g}$, indeed
\begin{align*}
	&c_{1,f} < c_{1,g} \iff \dfrac{\kappa_p^{d/p}}{A} < \left(\dfrac{p-1}{q}\right)^{d/q}\dfrac1{B} \iff \dfrac{B}{A} < \kappa_p^{d\left( \frac1{q}-\frac1{p}\right)}\left(\dfrac{p}{q}\right)^{d/q}\\
	&c_{2,f} > c_{2,g} \iff \left(\dfrac{q-1}{p}\right)^{d/p}\dfrac1{A} > \dfrac{\kappa_q^{d/q}}{B} \iff \dfrac{B}{A} > \kappa_q^{d\left( \frac1{p}-\frac1{q}\right)}\left(\dfrac{q}{p}\right)^{d/p}
\end{align*}
Since there is this dispositions of these points we expect there is an intersection between the level sets. Firstly we notice that, for every $c_1 \in (0,c_{1,f})$ there exist a unique value of $c_2$ for which $f(c_1,c_2) = A^p$. Indeed, from previous computations we notice that $f(c_1,0)$ is a decreasing function hence $f(c_1,0) > A^p$, while $\lim_{c_2 \rightarrow +\infty} f(c_1,c_2) = 0$. The uniqueness of this value follows from strict monotonicity of $f(c_1,\cdot)$, in fact:
\begin{equation}\label{df/dc1}
	\pfrac{f}{c_1}(c_1,c_2) = -\dfrac{p(p-1)}{(d-1)!}c_1^{p-2}\ \int_0^T \dfrac{t^{2(p-1)}}{(c_1t)^{p-1}+(c_2t)^{q-1}} \left[ -\log\left((c_1t)^{p-1} + (c_2t)^{q-1}\right) \right]^{d-1}dt
\end{equation}
is always strictly negative. We point out that the term $\frac{\partial T}{\partial c_1}(c_1,c_2)u(T;c_1,c_2)$ is zero because $u$ is 0 in $T$. The same is true for $g$, therefore on the interval $(0,c_{1,f})$ the level sets of $f$ and $g$ can be seen as the graph of two functions $\varphi, \gamma$. Since $\frac{\partial f}{\partial c_2}, \frac{\partial g}{\partial c_2} < 0$ for every $(c_1,c_2)$ from the implicit function theorem we have that $\varphi$ and  $\gamma$ are differentiable with respect to $c_1$.\\
{\large{\textbf{Possibile disegno??}}}\\
After defining $\varphi$ and $\gamma$ we want to prove that $(\varphi-\gamma)' < 0$. Still from the implicit function theorem we have
\begin{equation*}
	\begin{split}
		\dfrac{\mathrm{d}}{\mathrm{d} c_1}(\varphi - \gamma)(c_1) = -\dfrac{\pfrac{f}{c_1}(c_1,\varphi(c_1))}{\pfrac{f}{c_2}(c_1,\varphi(c_1))}  + 
		\dfrac{\pfrac{g}{c_1}(c_1,\gamma(c_1))}{\pfrac{g}{c_2}(c_1,\gamma(c_1))} < 0 \iff \\
		\pfrac{f}{c_1}(c_1,\varphi(c_1)) \pfrac{g}{c_2}(c_1,\gamma(c_1)) - \pfrac{f}{c_2}(c_1,\varphi(c_1)) \pfrac{g}{c_1}(c_1,\gamma(c_1)) > 0
	\end{split}
\end{equation*}
As for \eqref{df/dc1} the other derivatives are computed. To simplify the notation we define $h(t;c_1,c_2) = \frac{1}{(d-1)!}\frac{1}{(c_1t)^{p-1}+(c_2t)^{q-1}}\left[ -\log\left((c_1t)^{p-1} + (c_2t)^{q-1}\right) \right]^{d-1}$. From Fubini's theorem we can write the product of the integrals as a double integral
\begin{equation*}
	\begin{split}
		&p(p-1)q(q-1)c_1^{p-2}\gamma(c_1)^{q-2} \iint_{[0,T]^2} h(t;c_1,\varphi(c_2)) h(s;c_1,\gamma(c_2)) t^{2(p-1)} s^{2(q-1)} dtds -\\ &p(q-1)q(p-1)c_1^{p-2}\varphi(c_1)^{q-2} \iint_{[0,T]^2} h(t;c_1,\varphi(c_2)) h(s;c_1,\gamma(c_2)) t^{p+q-2} s^{p+q-2} dtds
	\end{split}
\end{equation*}
At the intersection point $\varphi(c_1)=\gamma(c_1)$ hence the sign of the previous expression depends only on the sign of
\begin{equation*}
	\begin{split}
		&\iint_{[0,T]^2} h(t;c_1,\varphi(c_1)) h(s;c_1,\gamma(c_1))\left( t^{2(p-1)} s^{2(q-1)} - t^{p+q-2} s^{p+q-2} \right)dtds=\\
		&=\iint_{[0,T]^2} h(t;c_1,\varphi(c_1)) h(s;c_1,\gamma(c_1)) t^{p-2}s^{q-2}\left( t^p s^q - t^q s^p \right)dtds\\
	\end{split}
\end{equation*}
In order to simplify the notation once again we set $H(t,s;c_1) = h(t;c_1,\varphi(c_1)) h(s;c_1,\gamma(c_1))$. Let $T_1 = [0,T]^2 \cap \{t>s\}$ and $T_2 = [0,T]^2 \cap \{t<s\}$. We can split the above integral in two parts
\begin{equation*}
	\begin{split}
		\iint_{T_1} H(t,s;c_1)t^{p-2}s^{q-2}\left( t^p s^q - t^q s^p \right)dtds + \iint_{T_2} H(t,s;c_1)t^{p-2}s^{q-2}\left( t^p s^q - t^q s^p \right)dtds
	\end{split}
\end{equation*}
We can exchange $t$ with $s$ in the second integral. With this change of variables the domain of integration becomes $T_1$ and since $H$ is symmetric in $t$ and $s$ we have that the previous quantity is equal to
\begin{equation*}
	\begin{split}
		&\iint_{T_1} H(t,s;c_1)\left( t^{p-2} s^{q-2} - t^{q-2} s^{p-2} \right) \left( t^p s^q - t^q s^p \right)dtds =\\
		&\iint_{T_1} H(t,s;c_1)\dfrac{1}{t^2 s^2}\left( t^p s^q - t^q s^p \right)^2 dtds
	\end{split}
\end{equation*}
which is strictly positive.

Now we are able to prove the uniqueness of multipliers.\\
First of all, since $(\varphi-\gamma)'<0$ whenever $\varphi(c_1) = \gamma(c_1)$, for every point of intersection there exist $\delta>0$ such that $\varphi(t) > \gamma(t)$ for $t \in (c_1 - \delta, c_1)$ while $\varphi(t) < \gamma(t)$ for $t \in (c_1, c_1 + \delta)$.\\
Define $c_1^* \coloneqq \sup \{c_1 \in [0,c_{1,f}] : \forall t \in [0,c_1] \ \varphi(t) \geq \gamma(t)\}$. This is an intersection point between $\varphi$ and $\gamma$ (if $\varphi(c_1^*) > \gamma(c_1^*)$ due to continuity there would be $\varepsilon > 0$ such that $\varphi(c_1^*+\varepsilon) > \gamma(c_1^*+\varepsilon)$ which contradicts the definition of $c_1^*$) and it is the first one, because we saw that after every intersection point there is an interval where $\varphi < \gamma$. Lastly, since $\varphi(0) > \gamma(0)$ and $\varphi(c_{1,f}) = 0 < \gamma(c_1,f)$ we have that $0 < c_1^* < c_{1,f}$.\\
Suppose now that there is a second point of intersection $\tilde{c}_1$ after the first one. Since immediately after $c_1^*$ we have that $\varphi$ becomes smaller than $\gamma$ this second point of intersection is given by $\tilde{c}_1 = \sup \{c_1 \in [c_1^*,c_{1,f}] : \forall t \in [c_1^*,c_1] \ \varphi(t) \leq \gamma(t)\}$. Considering that this is an intersection point, there exist an interval before $\tilde{c}_1$ where $\varphi$ is strictly grater than $\gamma$ which is absurd, hence $c_1^*$ is the only intersection point between $\varphi$ and $\gamma$.\\
Therefore $(c_1^*, \varphi(c_1^*) = c_2^*)$ is the unique pair of multipliers for which $p\int_0^T t^{p-1} u(t;c_1^*,c_2^*)dt = A^p,\ q\int_0^T t^{q-1} u(t;c_1^*,c_2^*)dt = B^q$ and in the end $u(t;c_1^*,c_2^*)$ is the unique maximizer for \textbf{CITARE PROBLEMA VARIAZIONALE}

\nocite{*}
\printbibliography


	

\end{document}32